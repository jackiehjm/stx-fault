---

- project:
    templates:
      - publish-stx-docs
      - stx-api-ref-jobs
      - stx-release-notes-jobs
      - stx-lint-specfile-jobs
    check:
      jobs:
        - openstack-tox-linters
        - openstack-tox-pep8
        - stx-fault-build
        - fault-rest-api-py27
        - fault-rest-api-py35
    gate:
      jobs:
        - openstack-tox-linters
        - openstack-tox-pep8
        - fault-rest-api-py27
        - fault-rest-api-py35

# Perform just a build
- job:
    name: stx-fault-build
    parent: tox
    description: Run build for fault
    irrelevant-files:
      - api-ref/*
      - docs/*
      - releasenotes/*
    vars:
      tox_envlist: build

- job:
    name: flock-devstack-fault
    parent: flock-devstack-base-min
    required-projects:
      # - name: starlingx/config
      - name: starlingx/integ
      - name: starlingx/update
    vars:
      tox_envlist: functional
      devstack_services:
        # cgtsclient: true
        fm-common: true
        fm-api: true
        fm-rest-api: true
        fm-mgr: true
      devstack_plugins:
        # config: https://opendev.org/starlingx/config
        fault: https://opendev.org/starlingx/fault
        integ: https://opendev.org/starlingx/integ
        update: https://opendev.org/starlingx/update

- job:
    name: fault-rest-api-py27
    parent: tox
    description: |
      Run py27 test for fm-rest-api
    nodeset: ubuntu-xenial
    required-projects:
      - starlingx/config
    vars:
      tox_envlist: py27
      tox_extra_args: -c fm-rest-api/fm/tox.ini

- job:
    name: fault-rest-api-py35
    parent: tox
    description: |
      Run py35 test for fm-rest-api
    nodeset: ubuntu-xenial
    required-projects:
      - starlingx/config
    vars:
      tox_envlist: py35
      tox_extra_args: -c fm-rest-api/fm/tox.ini
